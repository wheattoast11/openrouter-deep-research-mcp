# Idempotency Configuration for OpenRouter Agents
# Copy relevant settings to your .env file

# ============================================================================
# IDEMPOTENCY SETTINGS
# ============================================================================

# Enable/disable idempotency system (default: true)
IDEMPOTENCY_ENABLED=true

# Time-to-live for idempotency keys in seconds (default: 3600 = 1 hour)
# After this time, duplicate submissions will create new jobs
# Recommended: 1800-7200 (30 min - 2 hours)
IDEMPOTENCY_TTL_SECONDS=3600

# Background cleanup interval in milliseconds (default: 600000 = 10 minutes)
# How often to remove expired keys from database
IDEMPOTENCY_CLEANUP_INTERVAL_MS=600000

# Hash algorithm for key generation (default: sha256)
# Options: sha256, sha512, md5 (not recommended)
IDEMPOTENCY_HASH_ALGORITHM=sha256

# Idempotency key length (default: 16)
# Number of characters to use from hash (8-64)
# 16 chars = 2^64 combinations, very low collision risk
IDEMPOTENCY_KEY_LENGTH=16

# ============================================================================
# RETRY POLICY
# ============================================================================

# Allow retry when previous job failed (default: true)
# If false, failed jobs return error unless force_new=true
IDEMPOTENCY_RETRY_ON_FAILURE=true

# Retry window in seconds (default: 300 = 5 minutes)
# Count retries within this window for rate limiting
IDEMPOTENCY_RETRY_WINDOW_SECONDS=300

# Maximum retries per idempotency key within window (default: 3)
# After this many failures, require force_new=true
IDEMPOTENCY_MAX_RETRIES=3

# ============================================================================
# USAGE EXAMPLES
# ============================================================================

# Conservative (minimize duplicates, longer cache):
# IDEMPOTENCY_TTL_SECONDS=7200
# IDEMPOTENCY_RETRY_ON_FAILURE=false

# Aggressive (fresh results, allow retries):
# IDEMPOTENCY_TTL_SECONDS=1800
# IDEMPOTENCY_RETRY_ON_FAILURE=true
# IDEMPOTENCY_MAX_RETRIES=5

# Development (disabled for testing):
# IDEMPOTENCY_ENABLED=false

# Production (balanced):
# IDEMPOTENCY_ENABLED=true
# IDEMPOTENCY_TTL_SECONDS=3600
# IDEMPOTENCY_RETRY_ON_FAILURE=true
# IDEMPOTENCY_MAX_RETRIES=3
